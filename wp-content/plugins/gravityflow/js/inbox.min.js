!function(a,b){b(document).ready(function(){b(".gravityflow-actions-unlock").click(function(){var a=b(this),c=a.siblings(".gravityflow-actions-lock"),d=a.siblings(".gravityflow-actions-note-field-container"),e=a.siblings(".gravityflow-actions");a.hide(),c.show(),d.hide(),e.hide(),a.parent(".gravityflow-actions").addClass("gravityflow-actions-locked")}),b(".gravityflow-action").click(function(){var a=b(this),c=a.siblings(".gravityflow-actions-unlock"),d=a.siblings(".gravityflow-actions-lock"),e=a.siblings(".gravityflow-actions-note-field-container"),f=e.find("textarea"),g=a.data("note_field");if(!a.hasClass("gravityflow-action-processed")){if(a.parent(".gravityflow-actions").hasClass("gravityflow-actions-locked"))return a.parent(".gravityflow-actions").removeClass("gravityflow-actions-locked"),d.hide(),c.show(),void(g?(e.show(),f.focus(),b(document).keyup(function(a){var b=27;a.keyCode==b&&c.click()})):setTimeout(function(){a.hasClass("gravityflow-action-processing")||a.hasClass("gravityflow-action-processed")||(a.parent(".gravityflow-actions").addClass("gravityflow-actions-locked"),d.show(),c.hide())},2e3));var h=parseInt(a.data("entry_id")),i=a.data("rest_base"),j=a.data("action"),k=gravityflow_inbox_strings.restUrl,l=gravityflow_inbox_strings.nonce,m=a.siblings(".gravityflow-actions-spinner");b.ajax({method:"POST",url:k+"gf/v2/entries/"+h+"/workflow/"+i,data:{action:j,gravityflow_note:f.val()},beforeSend:function(b){b.setRequestHeader("X-WP-Nonce",l),a.siblings().andSelf().hide(),a.addClass("gravityflow-action-processing"),m.show()},success:function(b){m.hide(),a.removeClass("gravityflow-action-processing"),"success"==b.status?(a.addClass("gravityflow-action-processed"),a.prop("title",b.feedback),a.show(),a.parent(".gravityflow-actions").removeClass("gravityflow-actions-locked")):(a.parent(".gravityflow-actions").addClass("gravityflow-actions-locked"),a.siblings(".gravityflow-action").andSelf().show(),d.show(),alert(b.feedback))},fail:function(b){m.hide(),c.hide(),d.show(),a.removeClass("gravityflow-action-processing"),a.siblings(".gravityflow-actions").andSelf().show(),alert(b)}})}})})}(window.GravityFlowInbox=window.GravityFlowInbox||{},jQuery);